## 代码块&类的加载

​	代码块/初始化块，属于类中的成员，类似只有方法体的方法。在创建对象时隐式调用。

* 语法：`[修饰符]{ 代码 };`
* 修饰符只有不写或static两种。使用static的为静态代码块。

### 普通代码块

​	没有static修饰的代码块。会在每次创建对象实例时被隐式调用。

* 每次创建对象时（调用任何构造器）都会先调用代码块。

* 只使用类的静态成员时，普通代码块不会执行。

* 代码块的调用是优先于构造器的。

* 可以理解成是另一种形式的构造器，对构造器的补充机制。

  可用于提取多个构造器中的重复语句进行复用。

### 静态代码块

​	static修饰的代码块。

* 静态代码块在**类加载**的时候执行，且只会执行一次。

* 静态代码块只能直接调用静态成员。

* 类什么时候被加载：

  * 创建对象实例时（new）。

  * 创建子类对象实例时，或使用子类静态成员时，父类也会被加载。

    且父类先被加载，子类后被加载。

  * 使用类的静态成员时。

### 创建对象时的调用顺序

* 一个类在创建一个对象时，调用顺序如下：（示例代码可见`OOP.CodeBlock.ClassLoad02`）
  1. 调用静态代码块和进行静态属性初始化。多个静态属性/静态代码块则按定义顺序调用。
  2. 调用普通代码块和进行普通属性初始化。多个普通属性/普通代码块则按定义顺序调用。
  3. 调用构造器。

* 在调用构造器时，会首先进行一系列操作。

  可以认为在构造器的所有代码之前有一些隐含的代码。

  1. super() 调用父类无参构造器。
  2. 调用普通代码块。

* 在存在继承关系时，调用顺序如下：

  1. 父类的静态代码块和静态属性。优先级一样按定义顺序执行。
  2. 子类的静态代码块和静态属性。优先级一样按定义顺序执行。
  3. 父类的普通代码块和普通属性。优先级一样按定义顺序执行。
  4. 父类的构造方法。
  5. 子类的普通代码块和普通属性。优先级一样按定义顺序执行。
  6. 子类的构造方法。

  可以认为是：

  1. 进行类的加载。以祖先类->后代类的顺序加载所有类。

     该阶段执行所有静态代码块/静态属性初始化，从祖先类开始根据继承顺序依次执行一遍。

  2. 创建对象。构造器中隐含的`1.super();2.调用普通代码块`。

     以每一个类的 普通代码块->构造方法 的顺序，再次从祖先类开始根据继承顺序依次执行一遍。
